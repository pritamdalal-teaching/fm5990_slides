"0","library(fOptions)"
"0","library(bizdays)"
"0","library(tidyverse)"
"0","library(gridExtra)"
"0","type = ""c"""
"0","upx = seq(90, 110, 1)"
"0","strike = 100"
"0","time = 21/252"
"0","rf = 0.01"
"0","div = 0"
"0","vol = 0.25"
"0","option_values <-"
"0","  GBSCharacteristics("
"0","    TypeFlag = type"
"0","    , S = upx"
"0","    , X = strike"
"0","    , Time = time"
"0","    , r = rf"
"0","    , b = div"
"0","    , sigma = vol"
"0","  )"
"0","graph_values <-"
"0","  tibble("
"0","    upx = upx"
"0","    , intrinsic = map_dbl(upx, function(x) max(x - strike, 0))"
"0","    , px = option_values$premium"
"0","    , delta = option_values$delta"
"0","    , vega = option_values$vega / 100"
"0","    , theta = option_values$theta / 252"
"0","  )"
"0","p1 <-"
"0","ggplot(data = graph_values ) +"
"0","  geom_line(aes(x = upx, y = intrinsic), size = 0.75) +"
"0","  geom_line(aes(x = upx, y = px), color = ""green4"") +"
"0","  geom_vline(xintercept = 100, color = ""red"", lty = ""dashed"") +"
"0","  labs("
"0","       x = """""
"0","       ,y = """""
"0","  ) +"
"0","  annotate(""text"", label = ""option price"" , x = 93, y = 9.99, size = 4, colour = ""black"")"
"0","p2 <-"
"0","ggplot(data = graph_values ) +"
"0","  geom_line(aes(x = upx, y = delta), color = ""blue"") +"
"0","  geom_vline(xintercept = 100, color = ""red"", lty = ""dashed"") +"
"0","  labs("
"0","       x = """""
"0","       , y = """""
"0","  ) +"
"0","  annotate(""text"", label = ""delta"" , x = 91.5, y = 0.875, size = 4, colour = ""black"")"
"0","p3 <-"
"0","ggplot(data = graph_values ) +"
"0","  geom_line(aes(x = upx, y = vega), color = ""orange"") +"
"0","  geom_vline(xintercept = 100, color = ""red"", lty = ""dashed"") +"
"0","  labs("
"0","       x = ""underlying price"""
"0","       , y = """""
"0","  ) +"
"0","  annotate(""text"", label = ""vega"" , x = 91.5, y = .11, size = 4, colour = ""black"")"
"0","p4 <-"
"0","ggplot(data = graph_values ) +"
"0","  geom_line(aes(x = upx, y = theta), color = ""pink"") +"
"0","  geom_vline(xintercept = 100, color = ""red"", lty = ""dashed"") +"
"0","  labs("
"0","       x = ""underlying price"""
"0","       , y = """""
"0","  ) +"
"0","  annotate(""text"", label = ""theta"" , x = 93, y = -0.025, size = 4, colour = ""black"")"
"0","gridExtra::grid.arrange(p1, p2, p3, p4"
"0","                        , nrow = 2"
"0","                        , top = ""Greeks vs Underlying Price"")"
