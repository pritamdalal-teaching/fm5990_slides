"0","library(fOptions)"
"0","library(bizdays)"
"0","library(tidyverse)"
"0","library(gridExtra)"
"0","type = ""c"""
"0","upx = seq(90, 105, 1)"
"0","strike = 100"
"0","time = 21/252"
"0","rf = 0.01"
"0","div = 0"
"0","vol = seq(0.10, 0.30, 0.05)"
"0","df_graph_data <- tibble("
"0","  vol = 0"
"0","  , upx = upx"
"0","  , value = map_dbl(upx, function(x) max(x - strike, 0)) "
"0",")"
"0","for (ix_vol in 1: length(vol)){"
"0","## for ix_vol start ##########"
"0","option_values <- "
"0","  GBSCharacteristics("
"0","  TypeFlag = type"
"0","  , S = upx"
"0","  , X = strike"
"0","  , Time = time"
"0","  , r = rf"
"0","  , b = div"
"0","  , sigma = vol[ix_vol]"
"0","  )"
"0","df_add_values <- tibble("
"0","  vol = vol[ix_vol]"
"0","  , upx = upx"
"0","  , value = option_values$premium"
"0",")"
"0","df_graph_data <-"
"0","  bind_rows(df_graph_data, df_add_values)"
"0","## for ix_time end ############"
"0","}"
"0","# this is the plot mothafucka"
"0","ggplot() +"
"0","  geom_line("
"0","            data = df_graph_data %>% dplyr::filter(vol != 0)"
"0","            , aes(x = upx, y = value, color = factor(desc(vol)))"
"0","  ) +"
"0","  scale_color_discrete("
"0","                       name = ""volatility"""
"0","                       # , breaks = c(""21"", ""10"", ""5"", ""1"")"
"0","                       , labels = c(""0.30"", ""0.25"", ""0.20"", ""0.15"", ""0.10"")"
"0","  ) +"
"0","  geom_line("
"0","            data = df_graph_data %>% dplyr::filter(vol == 0)"
"0","            , aes(x = upx, y = value)"
"0","            , size = 0.75"
"0","  ) +"
"0","  theme(legend.position = c(0.15,0.65)) +"
"0","  labs("
"0","       title = ""The Effect of Volatility on Option Value"""
"0","       , x = ""underlying price"""
"0","       , y = ""option price"""
"0","  )"
